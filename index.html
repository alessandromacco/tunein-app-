<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tune In - Healing Frequencies</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    function TuneIn() {
      const [lang, setLang] = useState('it');
      const [selectedFreq, setSelectedFreq] = useState(432);
      const [customFreq, setCustomFreq] = useState(432);
      const [isPlaying, setIsPlaying] = useState(false);
      const [currentTime, setCurrentTime] = useState(0);
      const [duration, setDuration] = useState(0);
      const [volume, setVolume] = useState(0.7);
      const [isCustomMode, setIsCustomMode] = useState(false);
      const [showInfo, setShowInfo] = useState(false);

      const audioContextRef = useRef(null);
      const sourceNodeRef = useRef(null);
      const gainNodeRef = useRef(null);
      const audioElementRef = useRef(null);

      const AUDIO_URL = "https://tunein.b-cdn.net/Track.01.wav";
      const STANDARD_FREQ = 440;

      const FREQUENCIES = {
        396: { name: 'Muladhara', color: '#ef4444', desc: 'Liberation from Fear' },
        417: { name: 'Svadhisthana', color: '#f59e0b', desc: 'Facilitating Change' },
        432: { name: 'Universal', color: '#10b981', desc: 'Cosmic Harmony' },
        440: { name: 'Standard', color: '#3b82f6', desc: 'Western Standard' },
        528: { name: 'Manipura', color: '#8b5cf6', desc: 'Love Frequency' },
        639: { name: 'Anahata', color: '#ec4899', desc: 'Connecting Relationships' },
        741: { name: 'Vishuddha', color: '#f97316', desc: 'Awakening Intuition' },
        852: { name: 'Ajna', color: '#06b6d4', desc: 'Returning to Spirit' },
        963: { name: 'Sahasrara', color: '#a855f7', desc: 'Divine Consciousness' }
      };

      const TRANSLATIONS = {
        it: {
          title: 'Tune In',
          subtitle: 'Frequenze di Guarigione',
          presetMode: 'Frequenze Solfeggio',
          customMode: 'Frequenza Personalizzata',
          customFreq: 'Hz personalizzati (200-1000)',
          play: 'Play',
          pause: 'Pause',
          volume: 'Volume',
          info: 'Informazioni',
          infoText: 'Le frequenze Solfeggio sono toni specifici che promuovono vari aspetti della guarigione fisica e spirituale. Ogni frequenza corrisponde a un chakra specifico e ha propriet√† uniche per il bilanciamento energetico.',
          language: 'Lingua'
        },
        en: {
          title: 'Tune In',
          subtitle: 'Healing Frequencies',
          presetMode: 'Solfeggio Frequencies',
          customMode: 'Custom Frequency',
          customFreq: 'Custom Hz (200-1000)',
          play: 'Play',
          pause: 'Pause',
          volume: 'Volume',
          info: 'Information',
          infoText: 'Solfeggio frequencies are specific tones that promote various aspects of physical and spiritual healing. Each frequency corresponds to a specific chakra and has unique properties for energy balancing.',
          language: 'Language'
        }
      };

      const t = TRANSLATIONS[lang];

      // Initialize audio
      useEffect(() => {
        const audio = new Audio(AUDIO_URL);
        audio.crossOrigin = "anonymous";
        audioElementRef.current = audio;

        audio.addEventListener('loadedmetadata', () => setDuration(audio.duration));
        audio.addEventListener('timeupdate', () => setCurrentTime(audio.time));
        audio.addEventListener('ended', () => setIsPlaying(false));

        const AudioContext = window.AudioContext || window.webkitAudioContext;
        audioContextRef.current = new AudioContext();
        const source = audioContextRef.current.createMediaElementSource(audio);
        const gainNode = audioContextRef.current.createGain();
        
        source.connect(gainNode);
        gainNode.connect(audioContextRef.current.destination);
        
        sourceNodeRef.current = source;
        gainNodeRef.current = gainNode;

        return () => {
          audio.pause();
          audio.src = '';
          audio.load();
        };
      }, []);

      // Update frequency
      useEffect(() => {
        if (!audioElementRef.current) return;
        const targetFreq = isCustomMode ? customFreq : selectedFreq;
        const ratio = targetFreq / STANDARD_FREQ;
        audioElementRef.current.playbackRate = ratio;
      }, [selectedFreq, customFreq, isCustomMode]);

      // Update volume
      useEffect(() => {
        if (!gainNodeRef.current) return;
        gainNodeRef.current.gain.value = volume;
      }, [volume]);

      const handlePlayPause = async () => {
        if (!audioElementRef.current) return;
        
        if (audioContextRef.current.state === 'suspended') {
          await audioContextRef.current.resume();
        }

        if (isPlaying) {
          audioElementRef.current.pause();
        } else {
          await audioElementRef.current.play();
        }
        setIsPlaying(!isPlaying);
      };

      const handleSeek = (e) => {
        if (!audioElementRef.current) return;
        const seekTime = (e.target.value / 100) * duration;
        audioElementRef.current.currentTime = seekTime;
        setCurrentTime(seekTime);
      };

      const formatTime = (seconds) => {
        if (!seconds || isNaN(seconds)) return '0:00';
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs.toString().padStart(2, '0')}`;
      };

      const currentFreq = isCustomMode ? customFreq : selectedFreq;
      const freqData = FREQUENCIES[currentFreq] || FREQUENCIES[432];

      return (
        <div className="min-h-screen bg-gradient-to-br from-indigo-950 via-purple-950 to-pink-950 text-white p-4 md:p-8">
          <div className="max-w-4xl mx-auto">
            {/* Header */}
            <div className="text-center mb-8">
              <h1 className="text-6xl font-black text-white tracking-tight mb-4">
                {t.title}
              </h1>
              <p className="text-2xl text-purple-300 mb-6">{t.subtitle}</p>
              
              {/* Language Toggle */}
              <div className="flex justify-center gap-2">
                <button
                  onClick={() => setLang('it')}
                  className={`px-4 py-2 rounded-lg transition ${
                    lang === 'it' ? 'bg-purple-600' : 'bg-purple-900/30 hover:bg-purple-800/50'
                  }`}
                >
                  üáÆüáπ IT
                </button>
                <button
                  onClick={() => setLang('en')}
                  className={`px-4 py-2 rounded-lg transition ${
                    lang === 'en' ? 'bg-purple-600' : 'bg-purple-900/30 hover:bg-purple-800/50'
                  }`}
                >
                  üá¨üáß EN
                </button>
              </div>
            </div>

            {/* Mode Toggle */}
            <div className="mb-6 flex justify-center gap-4">
              <button
                onClick={() => setIsCustomMode(false)}
                className={`px-6 py-3 rounded-xl font-semibold transition ${
                  !isCustomMode 
                    ? 'bg-purple-600' 
                    : 'bg-purple-900/30 hover:bg-purple-800/50'
                }`}
              >
                {t.presetMode}
              </button>
              <button
                onClick={() => setIsCustomMode(true)}
                className={`px-6 py-3 rounded-xl font-semibold transition ${
                  isCustomMode 
                    ? 'bg-purple-600' 
                    : 'bg-purple-900/30 hover:bg-purple-800/50'
                }`}
              >
                {t.customMode}
              </button>
            </div>

            {/* Main Player Card */}
            <div className="bg-white/10 backdrop-blur-md rounded-2xl p-8 shadow-2xl border border-white/20">
              
              {/* Current Frequency Display */}
              <div className="text-center mb-8">
                <div 
                  className="text-8xl font-bold mb-2"
                  style={{ color: freqData.color }}
                >
                  {currentFreq}
                  <span className="text-4xl ml-2">Hz</span>
                </div>
                <div className="text-2xl font-semibold text-gray-300">{freqData.name}</div>
                <div className="text-lg text-gray-400 mt-1">{freqData.desc}</div>
              </div>

              {/* Frequency Selection */}
              {!isCustomMode ? (
                <div className="grid grid-cols-3 md:grid-cols-5 gap-3 mb-8">
                  {Object.entries(FREQUENCIES).map(([freq, data]) => (
                    <button
                      key={freq}
                      onClick={() => setSelectedFreq(Number(freq))}
                      className={`p-4 rounded-xl font-bold text-lg transition transform hover:scale-105 ${
                        selectedFreq === Number(freq)
                          ? 'ring-4 ring-white shadow-lg'
                          : 'opacity-60 hover:opacity-100'
                      }`}
                      style={{ 
                        backgroundColor: data.color,
                        color: 'white'
                      }}
                    >
                      {freq}
                    </button>
                  ))}
                </div>
              ) : (
                <div className="mb-8">
                  <label className="block text-center mb-4 text-lg font-semibold">
                    {t.customFreq}
                  </label>
                  <input
                    type="range"
                    min="200"
                    max="1000"
                    value={customFreq}
                    onChange={(e) => setCustomFreq(Number(e.target.value))}
                    className="w-full h-3 rounded-lg appearance-none cursor-pointer"
                    style={{
                      background: `linear-gradient(to right, ${freqData.color} 0%, ${freqData.color} ${((customFreq - 200) / 800) * 100}%, rgba(255,255,255,0.2) ${((customFreq - 200) / 800) * 100}%, rgba(255,255,255,0.2) 100%)`
                    }}
                  />
                  <div className="text-center mt-2 text-sm text-gray-400">200 Hz - 1000 Hz</div>
                </div>
              )}

              {/* Play/Pause Button */}
              <div className="flex justify-center mb-8">
                <button
                  onClick={handlePlayPause}
                  className="w-24 h-24 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 transition shadow-2xl flex items-center justify-center text-4xl transform hover:scale-105"
                >
                  {isPlaying ? '‚è∏' : '‚ñ∂'}
                </button>
              </div>

              {/* Progress Bar */}
              <div className="mb-6">
                <input
                  type="range"
                  min="0"
                  max="100"
                  value={duration ? (currentTime / duration) * 100 : 0}
                  onChange={handleSeek}
                  className="w-full h-2 rounded-lg appearance-none cursor-pointer bg-white/20"
                />
                <div className="flex justify-between text-sm text-gray-400 mt-2">
                  <span>{formatTime(currentTime)}</span>
                  <span>{formatTime(duration)}</span>
                </div>
              </div>

              {/* Volume Control */}
              <div className="mb-6">
                <label className="block text-center mb-2 text-sm font-semibold">
                  {t.volume}: {Math.round(volume * 100)}%
                </label>
                <input
                  type="range"
                  min="0"
                  max="100"
                  value={volume * 100}
                  onChange={(e) => setVolume(Number(e.target.value) / 100)}
                  className="w-full h-2 rounded-lg appearance-none cursor-pointer"
                  style={{
                    background: `linear-gradient(to right, ${freqData.color} 0%, ${freqData.color} ${volume * 100}%, rgba(255,255,255,0.2) ${volume * 100}%, rgba(255,255,255,0.2) 100%)`
                  }}
                />
              </div>

              {/* Info Button */}
              <div className="text-center">
                <button
                  onClick={() => setShowInfo(!showInfo)}
                  className="px-6 py-3 bg-white/10 hover:bg-white/20 rounded-lg transition backdrop-blur-sm"
                >
                  {t.info} {showInfo ? '‚ñ≤' : '‚ñº'}
                </button>
              </div>

              {/* Info Panel */}
              {showInfo && (
                <div className="mt-6 p-6 bg-white/5 rounded-xl backdrop-blur-sm border border-white/10">
                  <p className="text-gray-300 leading-relaxed">{t.infoText}</p>
                  <div className="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    {Object.entries(FREQUENCIES).map(([freq, data]) => (
                      <div key={freq} className="flex items-center gap-3">
                        <div 
                          className="w-4 h-4 rounded-full flex-shrink-0"
                          style={{ backgroundColor: data.color }}
                        />
                        <div>
                          <span className="font-bold">{freq} Hz</span> - {data.desc}
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>

            {/* Footer */}
            <div className="text-center mt-8 text-gray-400 text-sm">
              <p>üéµ Pure Healing Frequencies üéµ</p>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<TuneIn />, document.getElementById('root'));
  </script>
</body>
</html>
